import{d as e,f as l,dS as a,r as o,q as u,i as s,o as t,w as n,g as i,a as r,E as v,h as d,c as m,F as p,G as c,aq as f,y as g,x as b,t as _,a3 as w}from"./index-B3EiCo2S.js";import{a as y,E as h}from"./el-form-BuBNySiR.js";import{a as V,E as j}from"./el-col-DtKbKOG8.js";import{E as k}from"./el-divider-Bs0XUVOj.js";import{E as x}from"./el-tag-B27ii0Fj.js";import"./el-popper-BVxf87sZ.js";import"./el-virtual-list-Cb286V6z.js";import{E as F}from"./el-select-v2-Dup29apw.js";import{j as E,o as q,T as z}from"./index-DWP_hEdy.js";import{u as C,b as U}from"./index-DlJhDMIn.js";const D={class:"flex gap-2"},L=e({__name:"Detail",props:{closeDialog:{type:Function},getList:{type:Function},pocForm:{}},setup(e){const{t:L}=l(),M=[E(),q],N=e,{pocForm:R}=a(N),B=o({...R.value}),G=u({name:[{required:!0,message:L("poc.nameMsg"),trigger:"blur"}],level:[{required:!0,message:L("poc.contentMsg"),trigger:"blur"}]}),T=[{value:"critical",label:"critical"},{value:"high",label:"high"},{value:"medium",label:"medium"},{value:"low",label:"low"},{value:"info",label:"info"},{value:"unknown",label:"unknown"}],A=o(!1),I=o(),K=o([...R.value.tags]),O=o(""),P=o(!1),S=o(),H=()=>{P.value=!0,w((()=>{S.value.input.focus()}))},J=()=>{O.value&&K.value.push(O.value),P.value=!1,O.value=""};return(e,l)=>(t(),s(r(h),{model:B.value,"label-width":"120px",rules:G,"status-icon":"",ref_key:"ruleFormRef",ref:I},{default:n((()=>[i(r(y),{label:r(L)("poc.pocName"),prop:"name"},{default:n((()=>[i(r(v),{modelValue:B.value.name,"onUpdate:modelValue":l[0]||(l[0]=e=>B.value.name=e),placeholder:r(L)("poc.nameMsg")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),i(r(y),{label:r(L)("poc.content"),prop:"content"},{default:n((()=>[i(r(z),{modelValue:B.value.content,"onUpdate:modelValue":l[1]||(l[1]=e=>B.value.content=e),style:{height:"600px",width:"100%"},autofocus:!0,"indent-with-tab":!0,"tab-size":2,extensions:M},null,8,["modelValue"])])),_:1},8,["label"]),i(r(y),{label:r(L)("poc.level")},{default:n((()=>[i(r(F),{modelValue:B.value.level,"onUpdate:modelValue":l[2]||(l[2]=e=>B.value.level=e),placeholder:"Please select level",options:T},null,8,["modelValue"])])),_:1},8,["label"]),i(r(y),{label:"TAG"},{default:n((()=>[d("div",D,[(t(!0),m(p,null,c(K.value,(e=>(t(),s(r(x),{key:e,closable:"","disable-transitions":!1,onClose:l=>(e=>{K.value.splice(K.value.indexOf(e),1)})(e)},{default:n((()=>[b(_(e),1)])),_:2},1032,["onClose"])))),128)),P.value?(t(),s(r(v),{key:0,ref_key:"InputRef",ref:S,modelValue:O.value,"onUpdate:modelValue":l[3]||(l[3]=e=>O.value=e),class:"w-20",size:"small",onKeyup:f(J,["enter"]),onBlur:J},null,8,["modelValue"])):(t(),s(r(g),{key:1,class:"button-new-tag",size:"small",onClick:H},{default:n((()=>[b(" + New Tag ")])),_:1}))])])),_:1}),i(r(k)),i(r(V),null,{default:n((()=>[i(r(j),{span:2,offset:8},{default:n((()=>[i(r(y),null,{default:n((()=>[i(r(g),{type:"primary",onClick:l[4]||(l[4]=e=>(async e=>{A.value=!0,e&&await e.validate((async(e,l)=>{if(e){let e;e=""!=B.value.id?await C(B.value.id,B.value.name,B.value.content,B.value.level,K.value):await U(B.value.name,B.value.content,B.value.level,K.value),200===e.code&&(N.getList(),N.closeDialog()),A.value=!1}else A.value=!1}))})(I.value)),loading:A.value},{default:n((()=>[b(_(r(L)("task.save")),1)])),_:1},8,["loading"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"]))}});export{L as _};
