import{_ as e}from"./ContentWrap.vue_vue_type_script_setup_true_lang-D803gdbx.js";import{d as a,f as t,W as o,q as l,g as s,s as r,R as i,y as n,M as d,F as m,r as c,c as u,o as p,w as f,a as y,h as g,x as b,t as j,E as v,C as _,D as w,Q as h,_ as x}from"./index-B3EiCo2S.js";import{a as E,E as k}from"./el-col-DtKbKOG8.js";import{E as C}from"./el-upload-C2ca_cBE.js";import"./el-progress-dMr12y8C.js";import{E as U,a as S}from"./el-form-BuBNySiR.js";import{E as A}from"./el-tag-B27ii0Fj.js";import{_ as R}from"./Table.vue_vue_type_script_lang-cn7j-svV.js";import{_ as V}from"./Dialog.vue_vue_type_style_index_0_lang-Chb3ii7l.js";import{u as z}from"./useTable-iKdAFPEE.js";import{b as D,c as W,e as I,f as L}from"./index-C3HXxlbS.js";import"./el-card-CrrcCGp_.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-popper-BVxf87sZ.js";import"./index-BG_6nwkU.js";import"./index-DoD9gG_2.js";import"./castArray-BI5HMQaJ.js";import"./el-table-column-D1qTPSN1.js";import"./isArrayLikeObject-DH0T-Gqc.js";import"./debounce-BcWuyWDS.js";import"./el-checkbox-DISW8vgz.js";import"./raf-BaeSuW_0.js";import"./el-pagination-BrC_eYrZ.js";import"./el-select-CY6LOZx-.js";import"./strings-BciOnfsg.js";import"./index-DjN3fv7d.js";import"./el-image-viewer-CdBFXqlh.js";import"./el-empty-DcP8J_Rv.js";import"./tsxHelper-C_2HfyWV.js";import"./el-dropdown-item-D01yRie3.js";import"./refs-BF7DfOff.js";import"./index-8Peh_Rn3.js";import"./index-QUlrjjpt.js";const M={class:"mb-10px"},O={class:"mb-10px"};function B(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!h(e)}const F=x(a({__name:"manage",setup(a){const{t:h}=t(),x={Authorization:`${o().getToken}`},F=l([{field:"selection",type:"selection",width:"55"},{field:"id",hidden:!0},{field:"name",label:h("common.name"),minWidth:40},{field:"category",label:h("common.category"),minWidth:40,formatter:(e,a,t)=>s(A,{type:"success",effect:"light",size:"large"},B(t)?t:{default:()=>[t]})},{field:"size",label:h("common.filesize"),formatter:(e,a,t)=>t+"MB"},{field:"upload",label:h("common.upload"),formatter:(e,a,t)=>{const o=`/api/dictionary/manage/save?id=${e.id}`;return r("div",[r(C,{class:"upload-demo",action:o,headers:x,onSuccess:e=>{200===e.code?i.success("Upload succes"):i.error("Upload failed"),J()},onError:e=>{i.error(`Upload failed: ${e}`)}},(()=>r(n,{type:"warning"},h("common.cover"))))])}},{field:"download",label:h("common.download"),formatter:(e,a,t)=>{let o;return s(m,null,[s(d,{type:"primary",onClick:()=>se(e.id,e.name)},B(o=h("common.download"))?o:{default:()=>[o]})])}},{field:"action",label:h("tableDemo.action"),minWidth:40,formatter:(e,a,t)=>{let o;return s(m,null,[s(d,{type:"danger",onClick:()=>Y(e)},B(o=h("common.delete"))?o:{default:()=>[o]})])}}]),{tableRegister:H,tableState:T,tableMethods:$}=z({fetchDataApi:async()=>({list:(await D()).data.list})}),{loading:N,dataList:q}=T,{getList:J,getElTableExpose:K}=$;function Q(){return{background:"var(--el-fill-color-light)"}}const X=c(!1),G=c({name:"",category:""}),P=c(!1),Y=async e=>{if(window.confirm("Are you sure you want to delete this data?")){P.value=!0;try{await W([e.id]);P.value=!1,J()}catch(a){P.value=!1,J()}}},Z=c([]),ee=async()=>{window.confirm("Are you sure you want to delete the selected data?")&&await(async()=>{const e=await K(),a=(null==e?void 0:e.getSelectionRows())||[];Z.value=a.map((e=>e.id)),P.value=!0;try{await W(Z.value),P.value=!1,J()}catch(t){P.value=!1,J()}})()},ae=c();async function te(e){try{const a=e.file,t=new FormData;t.append("file",a),t.append("name",G.value.name),t.append("category",G.value.category),await L(t),J(),X.value=!1,i.success("Upload success")}catch(a){i.error(`Upload failed: ${a}`)}}async function oe(){ae.value.submit()}const le=async()=>{G.value.name="",X.value=!0},se=async(e,a)=>{const t=await I(e),o=window.URL.createObjectURL(new Blob([t.data])),l=document.createElement("a");l.href=o,l.setAttribute("download",a),document.body.appendChild(l),l.click(),document.body.removeChild(l)};return(a,t)=>(p(),u(m,null,[s(y(e),null,{default:f((()=>[s(y(E),{gutter:60},{default:f((()=>[s(y(k),{span:1},{default:f((()=>[g("div",M,[s(y(n),{type:"primary",onClick:le},{default:f((()=>[b(j(y(h)("common.new")),1)])),_:1})])])),_:1}),s(y(k),{span:1},{default:f((()=>[g("div",O,[s(y(d),{type:"danger",loading:P.value,onClick:ee},{default:f((()=>[b(j(y(h)("common.delete")),1)])),_:1},8,["loading"])])])),_:1})])),_:1}),s(y(R),{columns:F,data:y(q),stripe:"",border:!0,loading:y(N),resizable:!0,onRegister:y(H),headerCellStyle:Q,style:{fontFamily:"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji"}},null,8,["columns","data","loading","onRegister"])])),_:1}),s(y(V),{modelValue:X.value,"onUpdate:modelValue":t[2]||(t[2]=e=>X.value=e),title:y(h)("common.new"),center:"",style:{"border-radius":"15px","box-shadow":"5px 5px 10px rgb(0 0 0 / 30%)"},maxHeight:430},{default:f((()=>[s(y(U),{model:G.value,"label-width":"120px",class:"upload-form"},{default:f((()=>[s(y(S),{label:y(h)("common.name")},{default:f((()=>[s(y(v),{modelValue:G.value.name,"onUpdate:modelValue":t[0]||(t[0]=e=>G.value.name=e),placeholder:"Enter name"},null,8,["modelValue"])])),_:1},8,["label"]),s(y(S),{label:y(h)("common.category")},{default:f((()=>[s(y(v),{modelValue:G.value.category,"onUpdate:modelValue":t[1]||(t[1]=e=>G.value.category=e),placeholder:"Enter category"},null,8,["modelValue"])])),_:1},8,["label"]),s(y(S),{label:""},{default:f((()=>[s(y(C),{class:"upload-demo",drag:"",ref_key:"upload",ref:ae,"auto-upload":!1,limit:1,httpRequest:te},{default:f((()=>[s(y(_),{class:"avatar-uploader-icon"},{default:f((()=>[s(y(w))])),_:1})])),_:1},512)])),_:1}),s(y(S),null,{default:f((()=>[s(y(n),{type:"primary",onClick:oe},{default:f((()=>[b("Submit")])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])],64))}}),[["__scopeId","data-v-c7d1e7fe"]]);export{F as default};
