import{d as e,f as t,q as a,s as o,W as i,L as l,r as n,c as m,o as d,F as s,g as c,a as u,w as r,h as p,x as f,t as v,y as b,i as _,j as y,E as x,_ as h}from"./index-C335Dbyp.js";import{E as N,a as g}from"./el-col-CoU3axbs.js";import{E as w,a as V}from"./el-form-UGjKpEwN.js";import{E as j,b as T}from"./el-radio-group-C80jDT57.js";import{E as S}from"./el-text-Db18Yw9k.js";import{E as k}from"./el-switch-B1hfvIWf.js";import{E as U}from"./el-divider-BZYcCevV.js";import{E}from"./el-card-BWWcY-2r.js";import{_ as I}from"./Dialog.vue_vue_type_style_index_0_lang-D8ePpfD3.js";import{_ as A}from"./Table.vue_vue_type_script_lang-B0GMEQiF.js";import{u as C}from"./useTable-0ZX8kjQl.js";import{e as M,f as D,h as R,u as O,i as P,j as L}from"./index-B0CdzAmi.js";import"./castArray-DcfcP02G.js";import"./index-BWY9zJxx.js";import"./refs-Dt1UrLcT.js";import"./el-popper-BdVQ-fi9.js";import"./el-table-column-zfPBTCuQ.js";import"./isArrayLikeObject-B04zdnTS.js";import"./index-9a9sxpBE.js";import"./debounce-Bhx9ODHg.js";import"./el-checkbox-CqOvfBK0.js";import"./raf-iuS8F68J.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-tag-DSkaNW9P.js";import"./el-pagination-C3mrmel7.js";import"./el-select-DxgVe2hv.js";import"./strings-BnBs96OV.js";import"./index-DcJJBfbp.js";import"./el-image-viewer-CIXae_eq.js";import"./el-empty-CowUXZlY.js";import"./tsxHelper-Fpww6XuK.js";import"./el-dropdown-item-ypTXrub9.js";import"./index-DJomGW97.js";import"./index-D4TQOvlj.js";const W={class:"mb-10px"},H={style:{position:"relative",top:"12px"}},F=h(e({__name:"notification",setup(e){const{t:h}=t(),F=a([{field:"selection",type:"selection",width:"55"},{field:"name",label:"Name",minWidth:20},{field:"method",label:"Method",minWidth:20},{field:"url",label:"URL"},{field:"contentType",label:"Content Type",minWidth:25},{field:"data",label:"POST DATA"},{field:"state",label:h("common.state"),minWidth:25,formatter:(e,t,a)=>{let l="",n="";return 1==a?(l="#2eb98a",n=h("common.on")):(l="red",n=h("common.off")),o(g,{gutter:20},[o(N,{span:1},[o(i,{icon:"clarity:circle-solid",color:l,size:10})]),o(N,{span:5},[o(S,{type:"info"},n)])])}},{field:"action",label:h("tableDemo.action"),formatter:(e,t,a)=>o("div",[o(l,{type:"primary",onClick:()=>te(e)},h("common.edit")),o(l,{type:"danger",onClick:()=>oe(e)},h("common.delete"))])}]),{tableState:z,tableMethods:G}=C({fetchDataApi:async()=>({list:(await D()).data.list})}),{dataList:B}=z,{getList:J,getElTableExpose:q}=G,K=a({name:"",url:"",method:"GET",contentType:"raw",data:"",state:!0}),Q=a({dirScanNotification:!0,portScanNotification:!0,sensitiveNotification:!0,subdomainNotification:!0,subdomainTakeoverNotification:!0,pageMonNotification:!0,vulNotification:!0});(async()=>{const e=await R();Q.dirScanNotification=e.data.dirScanNotification,Q.portScanNotification=e.data.portScanNotification,Q.sensitiveNotification=e.data.sensitiveNotification,Q.subdomainNotification=e.data.subdomainNotification,Q.subdomainTakeoverNotification=e.data.subdomainTakeoverNotification,Q.pageMonNotification=e.data.pageMonNotification,Q.vulNotification=e.data.vulNotification})();const X=n(!1),Y=n(!1),Z=async()=>{$.value="",K.name="",K.url="",K.method="GET",K.contentType="raw",K.data="",K.state=!0,Y.value=!0},$=n(""),ee=n(!1),te=e=>{$.value=e.id,K.name=e.name,K.url=e.url,K.method=e.method,K.contentType=e.contentType,K.data=e.data,K.state=e.state,Y.value=!0},ae=n(!1),oe=async e=>{ae.value=!0;try{await M([e.id]);ae.value=!1,J()}catch(t){ae.value=!1,J()}},ie=n([]),le=async()=>{window.confirm("Are you sure you want to delete the selected data?")&&await ne()},ne=async()=>{const e=await q(),t=(null==e?void 0:e.getSelectionRows())||[];ie.value=t.map((e=>e.id)),ae.value=!0;try{await M(ie.value);ae.value=!1,J()}catch(a){ae.value=!1,J()}};return(e,t)=>(d(),m(s,null,[c(u(E),{shadow:"never",class:"mb-20px"},{header:r((()=>[c(u(g),null,{default:r((()=>[c(u(N),{span:3,style:{height:"100%"}},{default:r((()=>[p("span",null,v(u(h)("configuration.noticeConfig")),1)])),_:1})])),_:1})])),default:r((()=>[c(u(g),null,{default:r((()=>[c(u(N),{style:{position:"relative",top:"16px"}},{default:r((()=>[p("div",W,[c(u(l),{type:"primary",onClick:Z},{default:r((()=>[f(v(u(h)("configuration.newWebhookConfig")),1)])),_:1}),c(u(l),{type:"danger",loading:ae.value,onClick:le},{default:r((()=>[f(v(u(h)("common.delete")),1)])),_:1},8,["loading"])])])),_:1})])),_:1}),p("div",H,[c(u(A),{data:u(B),columns:F,stripe:"",border:!0,resizable:!0,maxHeight:"200",style:{fontFamily:"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji"}},null,8,["data","columns"])]),c(u(U)),c(u(w),{model:Q,"label-width":"auto","status-icon":"",ref:"ruleFormRef",style:{position:"relative",top:"1rem"}},{default:r((()=>[c(u(g),null,{default:r((()=>[c(u(N),{span:5},{default:r((()=>[c(u(V),{label:u(h)("subdomain.subdomainName")},{default:r((()=>[c(u(k),{modelValue:Q.subdomainNotification,"onUpdate:modelValue":t[0]||(t[0]=e=>Q.subdomainNotification=e),"inline-prompt":"","active-text":u(h)("common.switchAction"),"inactive-text":u(h)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),c(u(N),{span:5},{default:r((()=>[c(u(V),{label:u(h)("task.subdomainTakeover")},{default:r((()=>[c(u(k),{modelValue:Q.subdomainTakeoverNotification,"onUpdate:modelValue":t[1]||(t[1]=e=>Q.subdomainTakeoverNotification=e),"inline-prompt":"","active-text":u(h)("common.switchAction"),"inactive-text":u(h)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),c(u(N),{span:5},{default:r((()=>[c(u(V),{label:u(h)("dirScan.dirScanName")},{default:r((()=>[c(u(k),{modelValue:Q.dirScanNotification,"onUpdate:modelValue":t[2]||(t[2]=e=>Q.dirScanNotification=e),"inline-prompt":"","active-text":u(h)("common.switchAction"),"inactive-text":u(h)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1})])),_:1}),c(u(g),null,{default:r((()=>[c(u(N),{span:5},{default:r((()=>[c(u(V),{label:u(h)("task.portScan")},{default:r((()=>[c(u(k),{modelValue:Q.portScanNotification,"onUpdate:modelValue":t[3]||(t[3]=e=>Q.portScanNotification=e),"inline-prompt":"","active-text":u(h)("common.switchAction"),"inactive-text":u(h)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),c(u(N),{span:5},{default:r((()=>[c(u(V),{label:u(h)("sensitiveInformation.sensitiveInformationName")},{default:r((()=>[c(u(k),{modelValue:Q.sensitiveNotification,"onUpdate:modelValue":t[4]||(t[4]=e=>Q.sensitiveNotification=e),"inline-prompt":"","active-text":u(h)("common.switchAction"),"inactive-text":u(h)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1}),c(u(N),{span:5},{default:r((()=>[c(u(V),{label:u(h)("PageMonitoring.pageMonitoringName")},{default:r((()=>[c(u(k),{modelValue:Q.pageMonNotification,"onUpdate:modelValue":t[5]||(t[5]=e=>Q.pageMonNotification=e),"inline-prompt":"","active-text":u(h)("common.switchAction"),"inactive-text":u(h)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1})])),_:1}),c(u(g),null,{default:r((()=>[c(u(N),{span:5},{default:r((()=>[c(u(V),{label:u(h)("vulnerability.vulnerabilityName")},{default:r((()=>[c(u(k),{modelValue:Q.vulNotification,"onUpdate:modelValue":t[6]||(t[6]=e=>Q.vulNotification=e),"inline-prompt":"","active-text":u(h)("common.switchAction"),"inactive-text":u(h)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1})])),_:1}),c(u(g),null,{default:r((()=>[c(u(N),{span:2,offset:8},{default:r((()=>[c(u(V),null,{default:r((()=>[c(u(b),{type:"primary",onClick:t[7]||(t[7]=e=>(async()=>{X.value=!0,await O(Q.dirScanNotification,Q.portScanNotification,Q.sensitiveNotification,Q.subdomainNotification,Q.subdomainTakeoverNotification,Q.pageMonNotification,Q.vulNotification),X.value=!1})()),loading:X.value},{default:r((()=>[f(v(u(h)("common.submit")),1)])),_:1},8,["loading"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1}),c(u(I),{modelValue:Y.value,"onUpdate:modelValue":t[15]||(t[15]=e=>Y.value=e),title:u(h)("configuration.newWebhookConfig"),center:"",style:{"border-radius":"15px","box-shadow":"5px 5px 10px rgb(0 0 0 / 30%)"},maxHeight:"100"},{default:r((()=>[c(u(S),{class:"mx-2",type:"danger",size:"small",style:{position:"relative",left:"2rem"}},{default:r((()=>[f(v(u(h)("configuration.noticeHelp")),1)])),_:1}),c(u(w),{model:K,"label-width":"auto","status-icon":"",ref:"ruleFormRef",style:{position:"relative",top:"1rem"}},{default:r((()=>[c(u(V),{label:"Name",prop:"name"},{default:r((()=>[c(u(x),{modelValue:K.name,"onUpdate:modelValue":t[8]||(t[8]=e=>K.name=e),placeholder:"Input name."},null,8,["modelValue"])])),_:1}),c(u(V),{label:"Method",prop:"method"},{default:r((()=>[c(u(j),{modelValue:K.method,"onUpdate:modelValue":t[9]||(t[9]=e=>K.method=e)},{default:r((()=>[c(u(T),{value:"GET"},{default:r((()=>[f("GET")])),_:1}),c(u(T),{value:"POST"},{default:r((()=>[f("POST")])),_:1})])),_:1},8,["modelValue"])])),_:1}),c(u(V),{label:"URL",prop:"url"},{default:r((()=>[c(u(x),{modelValue:K.url,"onUpdate:modelValue":t[10]||(t[10]=e=>K.url=e),placeholder:"Input URL."},null,8,["modelValue"])])),_:1}),"POST"==K.method?(d(),_(u(V),{key:0,label:"Data Type",prop:"contentType"},{default:r((()=>[c(u(j),{modelValue:K.contentType,"onUpdate:modelValue":t[11]||(t[11]=e=>K.contentType=e)},{default:r((()=>[c(u(T),{value:"raw"},{default:r((()=>[f("Raw")])),_:1}),c(u(T),{value:"json"},{default:r((()=>[f("Json")])),_:1})])),_:1},8,["modelValue"])])),_:1})):y("",!0),"POST"==K.method?(d(),_(u(V),{key:1,label:"Data",prop:"Data"},{default:r((()=>[c(u(x),{modelValue:K.data,"onUpdate:modelValue":t[12]||(t[12]=e=>K.data=e),placeholder:"Input POST Data."},null,8,["modelValue"])])),_:1})):y("",!0),c(u(V),{label:u(h)("common.state")},{default:r((()=>[c(u(k),{modelValue:K.state,"onUpdate:modelValue":t[13]||(t[13]=e=>K.state=e),"inline-prompt":"","active-text":u(h)("common.switchAction"),"inactive-text":u(h)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"]),c(u(g),null,{default:r((()=>[c(u(N),{span:2,offset:8},{default:r((()=>[c(u(V),null,{default:r((()=>[c(u(b),{type:"primary",onClick:t[14]||(t[14]=e=>(async()=>{ee.value=!0,""==$.value?await P(K.name,K.url,K.method,K.contentType,K.data,K.state):await L($.value,K.name,K.url,K.method,K.contentType,K.data,K.state),J(),ee.value=!1,Y.value=!1})()),loading:ee.value},{default:r((()=>[f(v(u(h)("common.submit")),1)])),_:1},8,["loading"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","title"])],64))}}),[["__scopeId","data-v-1dbb301d"]]);export{F as default};
