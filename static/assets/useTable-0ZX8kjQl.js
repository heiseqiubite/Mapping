import{r as a,S as t,M as e,H as s,f as n,Q as l,a as o,a3 as c}from"./index-C335Dbyp.js";const{t:i}=n(),u=n=>{const{immediate:u=!0}=n,m=a(!1),r=a(1),d=a(20),g=a(0),y=a([]);t((()=>r.value),(()=>{w.getList()})),t((()=>d.value),(()=>{1===o(r)||(r.value=1),w.getList()})),e((()=>{u&&w.getList()}));const v=a(),f=a(),p=async()=>{await c();const a=o(v);return a},w={getList:async()=>{m.value=!0;try{const a=await(null==n?void 0:n.fetchDataApi());a&&(y.value=a.list,a.flag||(g.value=a.total||0))}catch(a){}finally{m.value=!1}},setProps:async(a={})=>{const t=await p();null==t||t.setProps(a)},setColumn:async a=>{const t=await p();null==t||t.setColumn(a)},addColumn:async(a,t)=>{const e=await p();null==e||e.addColumn(a,t)},delColumn:async a=>{const t=await p();null==t||t.delColumn(a)},getElTableExpose:async()=>(await p(),o(f)),refresh:()=>{w.getList()},delList:async a=>{const{fetchDelApi:t}=n;t&&s.confirm(i("common.delMessage"),i("common.delWarning"),{confirmButtonText:i("common.delOk"),cancelButtonText:i("common.delCancel"),type:"warning"}).then((async()=>{if(await t()){l.success(i("common.delSuccess"));const t=(o(g)%o(d)===a||1===o(d))&&o(r)>1?o(r)-1:o(r);r.value=t,w.getList()}}))}};return{tableRegister:(a,t)=>{v.value=a,f.value=o(t)},tableMethods:w,tableState:{currentPage:r,pageSize:d,total:g,dataList:y,loading:m}}};export{u};
