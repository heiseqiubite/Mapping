import{d as e,f as a,r as l,X as u,R as o,U as t,i as r,o as n,w as i,g as s,a as d,E as m,c as p,F as v,G as c,y as b,x as g,_ as f}from"./index-B3EiCo2S.js";import{a as _,E as y}from"./el-form-BuBNySiR.js";import"./el-tag-B27ii0Fj.js";import{E as S,a as V}from"./el-select-CY6LOZx-.js";import"./el-popper-BVxf87sZ.js";import{a as h,E as j}from"./el-col-DtKbKOG8.js";import{j as x,o as U,T as w}from"./index-DWP_hEdy.js";import{h as P,s as A}from"./index-jOLBrEFX.js";import"./castArray-BI5HMQaJ.js";import"./strings-BciOnfsg.js";import"./index-DoD9gG_2.js";import"./debounce-BcWuyWDS.js";import"./index-DjN3fv7d.js";import"./index-BG_6nwkU.js";import"./index-QUlrjjpt.js";const F=f(e({__name:"detail",props:{closeDialog:{type:Function},getList:{type:Function},id:{}},setup(e){const{t:f}=a(),F=e,L=l({name:"",version:"",module:"",parameter:"",help:"",introduction:"",source:""}),D=()=>{L.value={name:"",version:"",module:"",parameter:"",help:"",introduction:"",source:""},k.value=""},H=l({name:[{required:!0,message:"",trigger:"blur"}],module:[{required:!0,message:"",trigger:"change"}],source:[{required:!0,message:"",trigger:"blur"}]}),R=l([{label:"TargetHandler",value:"TargetHandler"},{label:"SubdomainScan",value:"SubdomainScan"},{label:"SubdomainSecurity",value:"SubdomainSecurity"},{label:"PortScanPreparation",value:"PortScanPreparation"},{label:"PortScan",value:"PortScan"},{label:"AssetMapping",value:"AssetMapping"},{label:"URLScan",value:"URLScan"},{label:"WebCrawler",value:"WebCrawler"},{label:"DirScan",value:"DirScan"},{label:"VulnerabilityScan",value:"VulnerabilityScan"},{label:"AssetHandle",value:"AssetHandle"},{label:"PortFingerprint",value:"PortFingerprint"},{label:"URLSecurity",value:"URLSecurity"},{label:"PassiveScan",value:"PassiveScan"}]),k=l(""),E=[x(),U];u((async()=>{D(),F.id&&await C(F.id)}));const I=l("");(()=>{const e=localStorage.getItem("plugin_key");I.value=e})();const q=l(!1),C=async e=>{try{const a=await P(e);if(200===a.code){const e=a.data;L.value.name=e.name,L.value.version=e.version,L.value.module=e.module,L.value.parameter=e.parameter,L.value.help=e.help,L.value.introduction=e.introduction,k.value=e.source,q.value=e.isSystem}else o.error(`数据加载失败：${a.message}`)}catch(a){}},z=l(!1);t((()=>F.id),(async e=>{""===e?D():await C(e)}));const M=async()=>{if(z.value=!0,""==L.value.name)return o.error("name 不能为空"),void(z.value=!1);if(""==L.value.module)return o.error("module 不能为空"),void(z.value=!1);if(!q.value&&""==k.value)return o.error("源码 不能为空"),void(z.value=!1);try{505==(await A(F.id,L.value.name,L.value.version,L.value.module,L.value.parameter,L.value.help,L.value.introduction,k.value,I.value)).code&&localStorage.removeItem("plugin_key"),F.closeDialog(),F.getList()}catch(e){o.error("保存失败，请稍后再试。")}finally{z.value=!1}};return(e,a)=>(n(),r(d(y),{model:L.value,rules:H.value,"label-width":"100px"},{default:i((()=>[s(d(h),{gutter:20},{default:i((()=>[s(d(j),{span:12},{default:i((()=>[s(d(_),{label:d(f)("plugin.name"),prop:"name"},{default:i((()=>[s(d(m),{modelValue:L.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>L.value.name=e),disabled:q.value},null,8,["modelValue","disabled"])])),_:1},8,["label"])])),_:1}),s(d(j),{span:12},{default:i((()=>[s(d(_),{label:d(f)("plugin.module"),prop:"module"},{default:i((()=>[s(d(S),{modelValue:L.value.module,"onUpdate:modelValue":a[1]||(a[1]=e=>L.value.module=e),disabled:q.value},{default:i((()=>[(n(!0),p(v,null,c(R.value,(e=>(n(),r(d(V),{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1},8,["label"])])),_:1}),s(d(j),{span:12},{default:i((()=>[s(d(_),{label:d(f)("plugin.parameter"),prop:"parameter"},{default:i((()=>[s(d(m),{modelValue:L.value.parameter,"onUpdate:modelValue":a[2]||(a[2]=e=>L.value.parameter=e)},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),s(d(j),{span:12},{default:i((()=>[s(d(_),{label:d(f)("plugin.help"),prop:"help"},{default:i((()=>[s(d(m),{modelValue:L.value.help,"onUpdate:modelValue":a[3]||(a[3]=e=>L.value.help=e)},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),s(d(j),{span:12},{default:i((()=>[s(d(_),{label:d(f)("plugin.version"),prop:"version"},{default:i((()=>[s(d(m),{modelValue:L.value.version,"onUpdate:modelValue":a[4]||(a[4]=e=>L.value.version=e),disabled:q.value},null,8,["modelValue","disabled"])])),_:1},8,["label"])])),_:1}),s(d(j),{span:24},{default:i((()=>[s(d(_),{label:d(f)("plugin.introduction"),prop:"introduction"},{default:i((()=>[s(d(m),{modelValue:L.value.introduction,"onUpdate:modelValue":a[5]||(a[5]=e=>L.value.introduction=e)},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),s(d(j),{span:24},{default:i((()=>[s(d(_),{label:"源码",prop:"source"},{default:i((()=>[s(d(w),{modelValue:k.value,"onUpdate:modelValue":a[6]||(a[6]=e=>k.value=e),style:{height:"400px",width:"90%"},autofocus:!0,"indent-with-tab":!0,"tab-size":2,extensions:E,disabled:q.value},null,8,["modelValue","disabled"])])),_:1})])),_:1})])),_:1}),s(d(h),null,{default:i((()=>[s(d(j),{span:12,style:{"text-align":"right"}},{default:i((()=>[s(d(b),{type:"primary",onClick:M,loading:z.value},{default:i((()=>[g(" 保存 ")])),_:1},8,["loading"])])),_:1})])),_:1})])),_:1},8,["model","rules"]))}}),[["__scopeId","data-v-ce8bbb13"]]);export{F as default};
