import{d as e,f as a,q as l,ad as t,r as o,M as s,c as d,o as u,F as n,g as r,a as i,w as p,j as c,E as m,x as g,t as f,i as h,G as v,y as _,am as b,Q as j,h as k}from"./index-C335Dbyp.js";import{E as x}from"./el-checkbox-CqOvfBK0.js";import{E as V}from"./el-divider-BZYcCevV.js";import{E as y,a as w}from"./el-form-UGjKpEwN.js";import{a as T,E}from"./el-col-CoU3axbs.js";import{E as N}from"./el-switch-B1hfvIWf.js";import"./el-tooltip-l0sNRNKZ.js";import{E as U}from"./el-popper-BdVQ-fi9.js";import{E as P,b as D}from"./el-radio-group-C80jDT57.js";import"./el-tag-DSkaNW9P.js";import"./el-virtual-list-B4IL-mhu.js";import{E as q}from"./el-select-v2-4evr8ql9.js";import{E as M}from"./el-input-number-Ca7WmFBy.js";import{E as A}from"./el-text-Db18Yw9k.js";import{a as C,E as z}from"./el-select-DxgVe2hv.js";import{b as S,c as F,e as R}from"./index-CQ8vTVrh.js";import{a as G}from"./index-Db6MGsay.js";import{_ as I}from"./Dialog.vue_vue_type_style_index_0_lang-D8ePpfD3.js";import{h as L}from"./index-nItDL_e6.js";import B from"./DetailTemplate-CVhzJ-nT.js";const H={key:0},O={style:{float:"left"}},Q=e({__name:"AddProject",props:{closeDialog:{type:Function},projectid:{},getProjectData:{type:Function},schedule:{type:Boolean}},setup(e){const{t:Q}=a();let J=l({name:"",tag:"",logo:"",target:"",ignore:"",scheduledTasks:!1,hour:24,node:[],allNode:!1,duplicates:"None",template:""});const K=e,W=t((()=>{const e={name:[{required:!0,message:Q("project.msgProject"),trigger:"blur"}],tag:[{required:!0,message:Q("project.msgProjectTag"),trigger:"blur"}],target:[{required:!0,message:Q("project.msgProjectScope"),trigger:"blur"}],node:[{required:!1,message:Q("task.nodeMsg"),trigger:"blur"}],template:[{required:!0,message:"Please select template",trigger:"blur"}]};return J.scheduledTasks&&(e.node=[{required:!0,message:Q("task.nodeMsg"),trigger:"blur"}]),e})),X=o(!1),Y=o(),Z=o(!1),$=o(!1),ee=o(!1),ae=o(!1),le=l([]),te=e=>{ee.value=!1,e?(J.node=[],le.forEach((e=>J.node.push(e.value)))):J.node=[]},oe=l([]),se=async()=>{oe.length=0;const e=await L("",1,1e3);e.data.list.length>0&&e.data.list.forEach((e=>{oe.push({value:e.id,label:e.name})}))};s((()=>{(async()=>{if(""!=K.projectid){$.value=!0;const e=await R(K.projectid);J.name=e.data.name,J.tag=e.data.tag,J.target=e.data.target,J.logo=e.data.logo,J.scheduledTasks=e.data.scheduledTasks,J.hour=e.data.hour,J.allNode=e.data.allNode,J.node=e.data.node,J.duplicates=e.data.duplicates,J.ignore=e.data.ignore,J.template=e.data.template,$.value=!1}})(),(async()=>{const e=await G();e.data.list.length>0?(ae.value=!1,e.data.list.forEach((e=>{le.push({value:e,label:e})}))):(ae.value=!0,j.warning(Q("node.onlineNodeMsg")))})(),se()}));const de=o("");let ue="";const ne=o(!1),re=async e=>{de.value=e,""!=e&&(ue=Q("task.editTemplate")),ne.value=!0},ie=()=>{ne.value=!1};return(e,a)=>(u(),d(n,null,[r(i(y),{model:i(J),"label-width":"auto",rules:W.value,"status-icon":"",ref_key:"ruleFormRef",ref:Y,loading:$.value},{default:p((()=>[r(i(w),{label:i(Q)("project.projectName"),prop:"name"},{default:p((()=>[r(i(m),{modelValue:i(J).name,"onUpdate:modelValue":a[0]||(a[0]=e=>i(J).name=e),placeholder:i(Q)("project.msgProject")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),r(i(w),{label:"TAG",prop:"tag"},{default:p((()=>[r(i(m),{modelValue:i(J).tag,"onUpdate:modelValue":a[1]||(a[1]=e=>i(J).tag=e),placeholder:i(Q)("project.msgProjectTag")},null,8,["modelValue","placeholder"])])),_:1}),r(i(w),{label:i(Q)("project.projectScope"),prop:"target"},{default:p((()=>[r(i(m),{modelValue:i(J).target,"onUpdate:modelValue":a[2]||(a[2]=e=>i(J).target=e),placeholder:i(Q)("task.msgTarget"),type:"textarea",autosize:{minRows:6,maxRows:15}},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),r(i(w),{label:i(Q)("task.ignore"),prop:"ignore"},{default:p((()=>[r(i(m),{modelValue:i(J).ignore,"onUpdate:modelValue":a[3]||(a[3]=e=>i(J).ignore=e),placeholder:i(Q)("task.ignoreMsg"),type:"textarea",rows:"10"},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),r(i(w),{label:"Logo",prop:"logo"},{default:p((()=>[r(i(m),{modelValue:i(J).logo,"onUpdate:modelValue":a[4]||(a[4]=e=>i(J).logo=e),placeholder:"http(s)://xxxxx.xx"},null,8,["modelValue"])])),_:1}),r(i(V),{"content-position":"center",style:{}},{default:p((()=>[g(f(i(Q)("project.scheduledTasks")),1)])),_:1}),r(i(T),null,{default:p((()=>[r(i(E),{span:6},{default:p((()=>[r(i(w),{label:i(Q)("project.scheduledTasks")},{default:p((()=>[r(i(U),{effect:"dark",content:i(Q)("project.msgScheduledTasks"),placement:"top"},{default:p((()=>[r(i(N),{modelValue:i(J).scheduledTasks,"onUpdate:modelValue":a[5]||(a[5]=e=>i(J).scheduledTasks=e),"inline-prompt":"","active-text":i(Q)("common.switchAction"),"inactive-text":i(Q)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["content"])])),_:1},8,["label"])])),_:1}),i(J).scheduledTasks?(u(),h(i(E),{key:0,span:12},{default:p((()=>[r(i(w),{label:i(Q)("project.cycle"),prop:"type"},{default:p((()=>[r(i(M),{modelValue:i(J).hour,"onUpdate:modelValue":a[6]||(a[6]=e=>i(J).hour=e),min:1,"controls-position":"right",size:"small"},null,8,["modelValue"]),r(i(A),{style:{position:"relative",left:"16px"}},{default:p((()=>[g("Hour")])),_:1})])),_:1},8,["label"])])),_:1})):c("",!0)])),_:1}),r(i(T),null,{default:p((()=>[r(i(E),null,{default:p((()=>[r(i(w),{label:i(Q)("configuration.runNowOne")},{default:p((()=>[r(i(N),{modelValue:Z.value,"onUpdate:modelValue":a[7]||(a[7]=e=>Z.value=e),"inline-prompt":"","active-text":i(Q)("common.switchAction"),"inactive-text":i(Q)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1})])),_:1}),i(J).scheduledTasks||Z.value?(u(),d("div",H,[r(i(T),null,{default:p((()=>[r(i(E),{span:12},{default:p((()=>[r(i(w),{label:i(Q)("task.nodeSelect"),prop:"node"},{default:p((()=>[r(i(q),{modelValue:i(J).node,"onUpdate:modelValue":a[8]||(a[8]=e=>i(J).node=e),filterable:"",options:le,placeholder:"Please select node",style:{width:"80%"},multiple:"","tag-type":"success","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":7},{header:p((()=>[r(i(x),{disabled:ae.value,indeterminate:ee.value,onChange:te},{default:p((()=>[g(" All ")])),_:1},8,["disabled","indeterminate"])])),_:1},8,["modelValue","options"])])),_:1},8,["label"])])),_:1}),r(i(E),{span:12},{default:p((()=>[r(i(w),{label:i(Q)("task.autoNode")},{default:p((()=>[r(i(U),{effect:"dark",content:i(Q)("task.selectNodeMsg"),placement:"top"},{default:p((()=>[r(i(N),{modelValue:i(J).allNode,"onUpdate:modelValue":a[9]||(a[9]=e=>i(J).allNode=e),"inline-prompt":"","active-text":i(Q)("common.switchAction"),"inactive-text":i(Q)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["content"])])),_:1},8,["label"])])),_:1})])),_:1}),r(i(V),{"content-position":"center",style:{left:"20%",width:"60%"}},{default:p((()=>[g(f(i(Q)("task.duplicates")),1)])),_:1}),r(i(T),null,{default:p((()=>[r(i(E),{span:24},{default:p((()=>[r(i(w),{label:i(Q)("task.duplicates"),prop:"type"},{default:p((()=>[r(i(P),{modelValue:i(J).duplicates,"onUpdate:modelValue":a[10]||(a[10]=e=>i(J).duplicates=e)},{default:p((()=>[r(i(D),{label:"None",name:"duplicates",checked:!0,value:"None"}),r(i(U),{effect:"dark",content:i(Q)("task.duplicatesMsg"),placement:"top"},{default:p((()=>[r(i(D),{label:i(Q)("task.duplicatesSubdomain"),name:"duplicates",value:"subdomain"},null,8,["label"])])),_:1},8,["content"])])),_:1},8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1}),r(i(V),{"content-position":"center",style:{left:"20%",width:"60%"}},{default:p((()=>[g(f(i(Q)("router.scanTemplate")),1)])),_:1}),r(i(w),{label:i(Q)("router.scanTemplate"),prop:"template"},{default:p((()=>[r(i(C),{modelValue:i(J).template,"onUpdate:modelValue":a[12]||(a[12]=e=>i(J).template=e),placeholder:"Please select template",style:{width:"30%"}},{footer:p((()=>[r(i(_),{type:"success",size:"small",plain:"",style:{"margin-left":"15px"},onClick:a[11]||(a[11]=b((e=>re("")),["stop"]))},{default:p((()=>[g(f(i(Q)("common.new")),1)])),_:1})])),default:p((()=>[(u(!0),d(n,null,v(oe,(e=>(u(),h(i(z),{key:e.value,label:e.label,value:e.value},{default:p((()=>[r(i(T),null,{default:p((()=>[r(i(E),{span:16},{default:p((()=>[k("span",O,f(e.label),1)])),_:2},1024),r(i(E),{span:8},{default:p((()=>[r(i(_),{type:"primary",size:"small",style:{"margin-left":"15px"},onClick:b((a=>re(e.value)),["stop"])},{default:p((()=>[g(f(i(Q)("common.edit")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label"])])):c("",!0),r(i(V)),r(i(T),null,{default:p((()=>[r(i(E),{span:2,offset:12},{default:p((()=>[r(i(w),null,{default:p((()=>[r(i(_),{type:"primary",onClick:a[13]||(a[13]=e=>(async e=>{X.value=!0,e&&(await e.validate((async(e,a)=>{e?""==K.projectid?(200===(await S(Z.value,J.name,J.tag,J.target,J.logo,J.scheduledTasks,J.hour,J.allNode,J.node,J.duplicates,J.ignore,J.template)).code&&K.closeDialog(),X.value=!1):(200===(await F(Z.value,K.projectid,J.name,J.tag,J.target,J.logo,J.scheduledTasks,J.hour,J.allNode,J.node,J.duplicates,J.ignore,J.template)).code&&K.closeDialog(),X.value=!1):X.value=!1})),K.getProjectData(1,50))})(Y.value)),loading:X.value},{default:p((()=>[g(f(i(Q)("task.save")),1)])),_:1},8,["loading"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules","loading"]),r(i(I),{modelValue:ne.value,"onUpdate:modelValue":a[14]||(a[14]=e=>ne.value=e),title:i(ue),center:"",fullscreen:"",style:{"border-radius":"15px","box-shadow":"5px 5px 10px rgb(0 0 0 / 30%)"}},{default:p((()=>[r(B,{closeDialog:ie,getList:se,id:de.value},null,8,["id"])])),_:1},8,["modelValue","title"])],64))}});export{Q as _};
