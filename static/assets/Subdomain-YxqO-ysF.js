import{d as e,f as t,H as l,J as a,r as o,q as i,g as s,E as n,x as r,F as m,i as u,o as d,w as p,a as c,j as f,y as h,O as j,R as b,Q as g,_ as y}from"./index-B3EiCo2S.js";import{u as v}from"./useTable-iKdAFPEE.js";import{E as x}from"./el-card-CrrcCGp_.js";import{E as S,a as _}from"./el-col-DtKbKOG8.js";import{E as w}from"./el-text-CmnqunHf.js";import{_ as C}from"./Table.vue_vue_type_script_lang-cn7j-svV.js";import{u as E}from"./useCrudSchemas-ClAqzrYC.js";import{f as T}from"./index-9ZiTTwM7.js";import{d as A}from"./index-DUOd3csz.js";import"./el-table-column-D1qTPSN1.js";import"./el-popper-BVxf87sZ.js";import"./index-BG_6nwkU.js";import"./isArrayLikeObject-DH0T-Gqc.js";import"./index-DoD9gG_2.js";import"./debounce-BcWuyWDS.js";import"./el-checkbox-DISW8vgz.js";import"./raf-BaeSuW_0.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-tag-B27ii0Fj.js";import"./el-pagination-BrC_eYrZ.js";import"./el-select-CY6LOZx-.js";import"./strings-BciOnfsg.js";import"./castArray-BI5HMQaJ.js";import"./index-DjN3fv7d.js";import"./el-image-viewer-CdBFXqlh.js";import"./el-empty-DcP8J_Rv.js";import"./tsxHelper-C_2HfyWV.js";import"./el-dropdown-item-D01yRie3.js";import"./refs-BF7DfOff.js";import"./index-8Peh_Rn3.js";import"./tree-BfZhwLPs.js";import"./index-QUlrjjpt.js";function I(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!g(e)}const N=y(e({__name:"Subdomain",props:{projectId:{}},setup(e){const{t:g}=t(),{query:y}=l(),N=e;a((()=>{W(),window.addEventListener("resize",W)}));const R=o(0),W=()=>{const e=window.innerHeight||document.documentElement.clientHeight;R.value=.8*e};o("");const z=i({});z.project=[N.projectId];const V=async e=>{Object.assign(z,e),F()},k=i([{field:"selection",type:"selection",minWidth:"55"},{field:"index",label:g("tableDemo.index"),type:"index",minWidth:"30"},{field:"host",label:g("subdomain.subdomainName"),minWidth:"200",formatter:(e,t,l)=>e.count?s(m,null,[s(w,null,I(l)?l:{default:()=>[l]}),s(w,{type:"info"},{default:()=>[r("("),e.count,r(")")]})]):s(w,null,I(l)?l:{default:()=>[l]}),slots:{header:()=>s("div",null,[s("span",null,[g("subdomain.subdomainName")]),s(n,{modelValue:P.value,"onUpdate:modelValue":e=>P.value=e,placeholder:"Search",style:"width: 200px; margin-left: 10px;",size:"small",onChange:()=>$("sub_host")},null)])}},{field:"type",label:g("subdomain.recordType"),minWidth:"200",columnKey:"type",filters:[{text:"A",value:"A"},{text:"NS",value:"NS"},{text:"CNAME",value:"CNAME"},{text:"PTR",value:"PTR"},{text:"TXT",value:"TXT"}]},{field:"value",label:g("subdomain.recordValue"),minWidth:"250",formatter:(e,t,l)=>{let a="";return l.forEach(((e,t)=>{a+=`${e}\r\n`})),a},slots:{header:()=>s("div",null,[s("span",null,[g("subdomain.recordValue")]),s(n,{modelValue:q.value,"onUpdate:modelValue":e=>q.value=e,placeholder:"Search",style:"width: 200px; margin-left: 10px;",size:"small",onChange:()=>$("sub_value")},null)])}},{field:"ip",label:"IP",minWidth:"150",formatter:(e,t,l)=>{let a="";return l.forEach(((e,t)=>{a+=`${e}\r\n`})),a},slots:{header:()=>s("div",null,[s("span",null,[r("IP")]),s(n,{modelValue:J.value,"onUpdate:modelValue":e=>J.value=e,placeholder:"Search",style:"width: 180px; margin-left: 10px;",size:"small",onChange:()=>$("sub_ip")},null)])}},{field:"time",label:g("asset.time"),minWidth:"200"}]),{allSchemas:O}=E(k),{tableRegister:H,tableState:U,tableMethods:D}=v({fetchDataApi:async()=>({list:(await T("",z,X)).data.list}),immediate:!0}),{loading:M,dataList:B}=U,{getList:F,getElTableExpose:K}=D;function L(){return{background:"var(--el-fill-color-light)"}}const P=o(""),q=o(""),J=o(""),X=i({}),$=async e=>{let t="";"sub_host"==e&&(t=P.value),"sub_value"==e&&(t=q.value),"sub_ip"==e&&(t=J.value),X[e]=t,F()},Q=o([]),G=async()=>{j.confirm("Whether to delete?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((async()=>{const e=await K(),t=(null==e?void 0:e.getSelectionRows())||[];Q.value=t.map((e=>e.id)),await A(Q.value,"subdomain"),F()})).catch((()=>{b({type:"info",message:"Delete canceled"})}))};let Y=o(!1);const Z=async()=>{const e=await K(),t=(null==e?void 0:e.getSelectionRows())||[];Q.value=t.map((e=>e.id)),0!=Q.value.length?Y.value=!0:Y.value=!1};return(e,t)=>(d(),u(c(_),null,{default:p((()=>[s(c(S),null,{default:p((()=>[s(c(x),{style:{height:"min-content"}},{default:p((()=>[c(Y)?(d(),u(c(h),{key:0,onClick:G,type:"danger",size:"small"},{default:p((()=>[r("Dlete")])),_:1})):f("",!0),s(c(C),{columns:c(O).tableColumns,data:c(B),stripe:"","max-height":R.value,border:!0,loading:c(M),onSelectionChange:Z,rowKey:"id",resizable:!0,onRegister:c(H),onFilterChange:V,headerCellStyle:L,style:{fontFamily:"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji"}},null,8,["columns","data","max-height","loading","onRegister"])])),_:1})])),_:1})])),_:1}))}}),[["__scopeId","data-v-30ca3560"]]);export{N as default};
