import{d as e,f as t,H as l,J as a,r as s,q as i,g as o,E as n,x as r,F as m,i as d,o as p,w as c,a as u,j as h,y as v,O as f,R as j,Q as g,_ as y}from"./index-B3EiCo2S.js";import{u as x}from"./useTable-iKdAFPEE.js";import{E as b}from"./el-card-CrrcCGp_.js";import{E as _,a as w}from"./el-col-DtKbKOG8.js";import{E as S}from"./el-text-CmnqunHf.js";import{_ as C}from"./Table.vue_vue_type_script_lang-cn7j-svV.js";import{u as E}from"./useCrudSchemas-ClAqzrYC.js";import{e as z}from"./index-9ZiTTwM7.js";import{d as I}from"./index-DUOd3csz.js";import"./el-table-column-D1qTPSN1.js";import"./el-popper-BVxf87sZ.js";import"./index-BG_6nwkU.js";import"./isArrayLikeObject-DH0T-Gqc.js";import"./index-DoD9gG_2.js";import"./debounce-BcWuyWDS.js";import"./el-checkbox-DISW8vgz.js";import"./raf-BaeSuW_0.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-tag-B27ii0Fj.js";import"./el-pagination-BrC_eYrZ.js";import"./el-select-CY6LOZx-.js";import"./strings-BciOnfsg.js";import"./castArray-BI5HMQaJ.js";import"./index-DjN3fv7d.js";import"./el-image-viewer-CdBFXqlh.js";import"./el-empty-DcP8J_Rv.js";import"./tsxHelper-C_2HfyWV.js";import"./el-dropdown-item-D01yRie3.js";import"./refs-BF7DfOff.js";import"./index-8Peh_Rn3.js";import"./tree-BfZhwLPs.js";import"./index-QUlrjjpt.js";function W(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!g(e)}const V=y(e({__name:"Service",props:{projectId:{}},setup(e){const{t:g}=t(),{query:y}=l(),V=e;a((()=>{O(),window.addEventListener("resize",O)}));const k=s(0),O=()=>{const e=window.innerHeight||document.documentElement.clientHeight;k.value=.8*e};s("");const R=i({});R.project=[V.projectId];const U=async e=>{Object.assign(R,e),K()},A=i([{field:"selection",type:"selection",minWidth:"55"},{field:"index",label:g("tableDemo.index"),type:"index",minWidth:"30"},{field:"service",label:g("asset.service"),minWidth:"100",formatter:(e,t,l)=>e.count?o(m,null,[o(S,null,W(l)?l:{default:()=>[l]}),o(S,{type:"info"},{default:()=>[r("("),e.count,r(")")]})]):o(S,null,W(l)?l:{default:()=>[l]}),slots:{header:()=>o("div",null,[o("span",null,[g("asset.service")]),o(n,{modelValue:Q.value,"onUpdate:modelValue":e=>Q.value=e,placeholder:"Search",style:"width: 80px; margin-left: 10px;",size:"small",onChange:()=>X("service_service")},null)])}},{field:"host",label:g("asset.domain"),minWidth:"200",slots:{header:()=>o("div",null,[o("span",null,[g("asset.domain")]),o(n,{modelValue:J.value,"onUpdate:modelValue":e=>J.value=e,placeholder:"Search",style:"width: 80px; margin-left: 10px;",size:"small",onChange:()=>X("service_domain")},null)])}},{field:"ip",label:"IP",minWidth:"250",slots:{header:()=>o("div",null,[o("span",null,[r("IP")]),o(n,{modelValue:P.value,"onUpdate:modelValue":e=>P.value=e,placeholder:"Search",style:"width: 200px; margin-left: 10px;",size:"small",onChange:()=>X("service_ip")},null)])}},{field:"port",label:g("asset.port"),minWidth:"250",slots:{header:()=>o("div",null,[o("span",null,[g("asset.port")]),o(n,{modelValue:q.value,"onUpdate:modelValue":e=>q.value=e,placeholder:"Search",style:"width: 200px; margin-left: 10px;",size:"small",onChange:()=>X("service_port")},null)])}},{field:"time",label:g("asset.time"),minWidth:"200"}]),{allSchemas:H}=E(A),{tableRegister:T,tableState:D,tableMethods:B}=x({fetchDataApi:async()=>({list:(await z("",R,G)).data.list}),immediate:!0}),{loading:F,dataList:L}=D,{getList:K,getElTableExpose:M}=B;function N(){return{background:"var(--el-fill-color-light)"}}const q=s(""),J=s(""),P=s(""),Q=s(""),G=i({}),X=async e=>{let t="";"service_port"==e&&(t=q.value),"service_domain"==e&&(t=J.value),"service_ip"==e&&(t=P.value),"service_service"==e&&(t=Q.value),G[e]=t,K()},Y=s([]),Z=async()=>{f.confirm("Whether to delete?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((async()=>{const e=await M(),t=(null==e?void 0:e.getSelectionRows())||[];Y.value=t.map((e=>e.id)),await I(Y.value,"asset"),K()})).catch((()=>{j({type:"info",message:"Delete canceled"})}))};let $=s(!1);const ee=async()=>{const e=await M(),t=(null==e?void 0:e.getSelectionRows())||[];Y.value=t.map((e=>e.id)),0!=Y.value.length?$.value=!0:$.value=!1};return(e,t)=>(p(),d(u(w),null,{default:c((()=>[o(u(_),null,{default:c((()=>[o(u(b),{style:{height:"min-content"}},{default:c((()=>[u($)?(p(),d(u(v),{key:0,onClick:Z,type:"danger",size:"small"},{default:c((()=>[r("Dlete")])),_:1})):h("",!0),o(u(C),{columns:u(H).tableColumns,data:u(L),"max-height":k.value,border:!0,loading:u(F),onSelectionChange:ee,rowKey:"id",resizable:!0,onRegister:u(T),onFilterChange:U,headerCellStyle:N,style:{fontFamily:"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji"}},null,8,["columns","data","max-height","loading","onRegister"])])),_:1})])),_:1})])),_:1}))}}),[["__scopeId","data-v-cba5a614"]]);export{V as default};
