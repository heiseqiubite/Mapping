import{d as e,f as l,q as a,I as t,r as o,J as s,c as d,o as u,F as n,g as r,a as i,w as p,j as c,E as m,G as g,x as f,t as v,i as h,y as _,ar as b,R as j,h as k}from"./index-B3EiCo2S.js";import{E as x}from"./el-checkbox-DISW8vgz.js";import{E as y}from"./el-divider-Bs0XUVOj.js";import{E as V,a as w}from"./el-form-BuBNySiR.js";import{a as T,E}from"./el-col-DtKbKOG8.js";import{E as N}from"./el-switch-CNw4GHOB.js";import"./el-tooltip-l0sNRNKZ.js";import{E as U}from"./el-popper-BVxf87sZ.js";import{E as P,b as D}from"./el-radio-group-CEHGycv7.js";import"./el-tag-B27ii0Fj.js";import"./el-virtual-list-Cb286V6z.js";import{E as q}from"./el-select-v2-Dup29apw.js";import{E as A}from"./el-input-number-DMRAGITy.js";import{E as C}from"./el-text-CmnqunHf.js";import{E as M,a as z}from"./el-select-CY6LOZx-.js";import{b as R,c as S,e as F}from"./index-CUwJOcjC.js";import{a as I}from"./index-DUjuAl0C.js";import{_ as G}from"./Dialog.vue_vue_type_style_index_0_lang-Chb3ii7l.js";import{f as L}from"./index-BGQZL4Fw.js";import B from"./DetailTemplate-CjMfz7vP.js";const H={key:0},O={style:{float:"left"}},J=e({__name:"AddProject",props:{closeDialog:{type:Function},projectid:{},getProjectData:{type:Function},schedule:{type:Boolean}},setup(e){const{t:J}=l(),K=[{value:"内网",label:"内网"},{value:"外网",label:"外网"}];let Q=a({name:"",tag:"",logo:"",target:"",ignore:"",scheduledTasks:!1,hour:24,node:[],allNode:!1,duplicates:"None",template:""});const W=e,X=t((()=>{const e={name:[{required:!0,message:J("project.msgProject"),trigger:"blur"}],tag:[{required:!0,message:J("project.msgProjectTag"),trigger:"blur"}],target:[{required:!0,message:J("project.msgProjectScope"),trigger:"blur"}],node:[{required:!1,message:J("task.nodeMsg"),trigger:"blur"}],template:[{required:!0,message:"Please select template",trigger:"blur"}]};return Q.scheduledTasks&&(e.node=[{required:!0,message:J("task.nodeMsg"),trigger:"blur"}]),e})),Y=o(!1),Z=o(),$=o(!1),ee=o(!1),le=o(!1),ae=o(!1),te=a([]),oe=e=>{le.value=!1,e?(Q.node=[],te.forEach((e=>Q.node.push(e.value)))):Q.node=[]},se=a([]),de=async()=>{se.length=0;const e=await L("",1,1e3);e.data.list.length>0&&e.data.list.forEach((e=>{se.push({value:e.id,label:e.name})}))};s((()=>{(async()=>{if(""!=W.projectid){ee.value=!0;const e=await F(W.projectid);Q.name=e.data.name,Q.tag=e.data.tag,Q.target=e.data.target,Q.logo=e.data.logo,Q.scheduledTasks=e.data.scheduledTasks,Q.hour=e.data.hour,Q.allNode=e.data.allNode,Q.node=e.data.node,Q.duplicates=e.data.duplicates,Q.ignore=e.data.ignore,Q.template=e.data.template,ee.value=!1}})(),(async()=>{const e=await I();e.data.list.length>0?(ae.value=!1,e.data.list.forEach((e=>{te.push({value:e,label:e})}))):(ae.value=!0,j.warning(J("node.onlineNodeMsg")))})(),de()}));const ue=o("");let ne="";const re=o(!1),ie=async e=>{ue.value=e,""!=e&&(ne=J("task.editTemplate")),re.value=!0},pe=()=>{re.value=!1};return(e,l)=>(u(),d(n,null,[r(i(V),{model:i(Q),"label-width":"auto",rules:X.value,"status-icon":"",ref_key:"ruleFormRef",ref:Z,loading:ee.value},{default:p((()=>[r(i(w),{label:i(J)("project.projectName"),prop:"name"},{default:p((()=>[r(i(m),{modelValue:i(Q).name,"onUpdate:modelValue":l[0]||(l[0]=e=>i(Q).name=e),placeholder:i(J)("project.msgProject")},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),r(i(w),{label:"TAG",prop:"tag"},{default:p((()=>[r(i(M),{modelValue:i(Q).tag,"onUpdate:modelValue":l[1]||(l[1]=e=>i(Q).tag=e),placeholder:i(J)("project.msgProjectTag"),style:{width:"100%"}},{default:p((()=>[(u(),d(n,null,g(K,(e=>r(i(z),{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),64))])),_:1},8,["modelValue","placeholder"])])),_:1}),r(i(w),{label:i(J)("project.projectScope"),prop:"target"},{default:p((()=>[r(i(m),{modelValue:i(Q).target,"onUpdate:modelValue":l[2]||(l[2]=e=>i(Q).target=e),placeholder:i(J)("task.msgTarget"),type:"textarea",autosize:{minRows:6,maxRows:15}},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),r(i(w),{label:i(J)("task.ignore"),prop:"ignore"},{default:p((()=>[r(i(m),{modelValue:i(Q).ignore,"onUpdate:modelValue":l[3]||(l[3]=e=>i(Q).ignore=e),placeholder:i(J)("task.ignoreMsg"),type:"textarea",rows:"10"},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),r(i(w),{label:"Logo",prop:"logo"},{default:p((()=>[r(i(m),{modelValue:i(Q).logo,"onUpdate:modelValue":l[4]||(l[4]=e=>i(Q).logo=e),placeholder:"http(s)://xxxxx.xx"},null,8,["modelValue"])])),_:1}),r(i(y),{"content-position":"center",style:{}},{default:p((()=>[f(v(i(J)("project.scheduledTasks")),1)])),_:1}),r(i(T),null,{default:p((()=>[r(i(E),{span:6},{default:p((()=>[r(i(w),{label:i(J)("project.scheduledTasks")},{default:p((()=>[r(i(U),{effect:"dark",content:i(J)("project.msgScheduledTasks"),placement:"top"},{default:p((()=>[r(i(N),{modelValue:i(Q).scheduledTasks,"onUpdate:modelValue":l[5]||(l[5]=e=>i(Q).scheduledTasks=e),"inline-prompt":"","active-text":i(J)("common.switchAction"),"inactive-text":i(J)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["content"])])),_:1},8,["label"])])),_:1}),i(Q).scheduledTasks?(u(),h(i(E),{key:0,span:12},{default:p((()=>[r(i(w),{label:i(J)("project.cycle"),prop:"type"},{default:p((()=>[r(i(A),{modelValue:i(Q).hour,"onUpdate:modelValue":l[6]||(l[6]=e=>i(Q).hour=e),min:1,"controls-position":"right",size:"small"},null,8,["modelValue"]),r(i(C),{style:{position:"relative",left:"16px"}},{default:p((()=>[f("Hour")])),_:1})])),_:1},8,["label"])])),_:1})):c("",!0)])),_:1}),r(i(T),null,{default:p((()=>[r(i(E),null,{default:p((()=>[r(i(w),{label:i(J)("configuration.runNowOne")},{default:p((()=>[r(i(N),{modelValue:$.value,"onUpdate:modelValue":l[7]||(l[7]=e=>$.value=e),"inline-prompt":"","active-text":i(J)("common.switchAction"),"inactive-text":i(J)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["label"])])),_:1})])),_:1}),i(Q).scheduledTasks||$.value?(u(),d("div",H,[r(i(T),null,{default:p((()=>[r(i(E),{span:12},{default:p((()=>[r(i(w),{label:i(J)("task.nodeSelect"),prop:"node"},{default:p((()=>[r(i(q),{modelValue:i(Q).node,"onUpdate:modelValue":l[8]||(l[8]=e=>i(Q).node=e),filterable:"",options:te,placeholder:"Please select node",style:{width:"80%"},multiple:"","tag-type":"success","collapse-tags":"","collapse-tags-tooltip":"","max-collapse-tags":7},{header:p((()=>[r(i(x),{disabled:ae.value,indeterminate:le.value,onChange:oe},{default:p((()=>[f(" All ")])),_:1},8,["disabled","indeterminate"])])),_:1},8,["modelValue","options"])])),_:1},8,["label"])])),_:1}),r(i(E),{span:12},{default:p((()=>[r(i(w),{label:i(J)("task.autoNode")},{default:p((()=>[r(i(U),{effect:"dark",content:i(J)("task.selectNodeMsg"),placement:"top"},{default:p((()=>[r(i(N),{modelValue:i(Q).allNode,"onUpdate:modelValue":l[9]||(l[9]=e=>i(Q).allNode=e),"inline-prompt":"","active-text":i(J)("common.switchAction"),"inactive-text":i(J)("common.switchInactive")},null,8,["modelValue","active-text","inactive-text"])])),_:1},8,["content"])])),_:1},8,["label"])])),_:1})])),_:1}),r(i(y),{"content-position":"center",style:{left:"20%",width:"60%"}},{default:p((()=>[f(v(i(J)("task.duplicates")),1)])),_:1}),r(i(T),null,{default:p((()=>[r(i(E),{span:24},{default:p((()=>[r(i(w),{label:i(J)("task.duplicates"),prop:"type"},{default:p((()=>[r(i(P),{modelValue:i(Q).duplicates,"onUpdate:modelValue":l[10]||(l[10]=e=>i(Q).duplicates=e)},{default:p((()=>[r(i(D),{label:"None",name:"duplicates",checked:!0,value:"None"}),r(i(U),{effect:"dark",content:i(J)("task.duplicatesMsg"),placement:"top"},{default:p((()=>[r(i(D),{label:i(J)("task.duplicatesSubdomain"),name:"duplicates",value:"subdomain"},null,8,["label"])])),_:1},8,["content"])])),_:1},8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1}),r(i(y),{"content-position":"center",style:{left:"20%",width:"60%"}},{default:p((()=>[f(v(i(J)("router.scanTemplate")),1)])),_:1}),r(i(w),{label:i(J)("router.scanTemplate"),prop:"template"},{default:p((()=>[r(i(M),{modelValue:i(Q).template,"onUpdate:modelValue":l[12]||(l[12]=e=>i(Q).template=e),placeholder:"Please select template",style:{width:"30%"}},{footer:p((()=>[r(i(_),{type:"success",size:"small",plain:"",style:{"margin-left":"15px"},onClick:l[11]||(l[11]=b((e=>ie("")),["stop"]))},{default:p((()=>[f(v(i(J)("common.new")),1)])),_:1})])),default:p((()=>[(u(!0),d(n,null,g(se,(e=>(u(),h(i(z),{key:e.value,label:e.label,value:e.value},{default:p((()=>[r(i(T),null,{default:p((()=>[r(i(E),{span:16},{default:p((()=>[k("span",O,v(e.label),1)])),_:2},1024),r(i(E),{span:8},{default:p((()=>[r(i(_),{type:"primary",size:"small",style:{"margin-left":"15px"},onClick:b((l=>ie(e.value)),["stop"])},{default:p((()=>[f(v(i(J)("common.edit")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label"])])):c("",!0),r(i(y)),r(i(T),null,{default:p((()=>[r(i(E),{span:2,offset:12},{default:p((()=>[r(i(w),null,{default:p((()=>[r(i(_),{type:"primary",onClick:l[13]||(l[13]=e=>(async e=>{Y.value=!0,e&&(await e.validate((async(e,l)=>{e?""==W.projectid?(200===(await R($.value,Q.name,Q.tag,Q.target,Q.logo,Q.scheduledTasks,Q.hour,Q.allNode,Q.node,Q.duplicates,Q.ignore,Q.template)).code&&W.closeDialog(),Y.value=!1):(200===(await S($.value,W.projectid,Q.name,Q.tag,Q.target,Q.logo,Q.scheduledTasks,Q.hour,Q.allNode,Q.node,Q.duplicates,Q.ignore,Q.template)).code&&W.closeDialog(),Y.value=!1):Y.value=!1})),W.getProjectData(1,50))})(Z.value)),loading:Y.value},{default:p((()=>[f(v(i(J)("task.save")),1)])),_:1},8,["loading"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules","loading"]),r(i(G),{modelValue:re.value,"onUpdate:modelValue":l[14]||(l[14]=e=>re.value=e),title:i(ne),center:"",fullscreen:"",style:{"border-radius":"15px","box-shadow":"5px 5px 10px rgb(0 0 0 / 30%)"}},{default:p((()=>[r(B,{closeDialog:pe,getList:de,id:ue.value},null,8,["id"])])),_:1},8,["modelValue","title"])],64))}});export{J as _};
